---
- name: Rule Test NetworkPolicy
  match:
    rules:
      - Test NetworkPolicy
  action:
    name: kubernetes:networkpolicy
- name: Rule Test Label
  match:
    priority: "Critical"
  action:
    name: kubernetes:labelize
    parameters:
      labels: 
        keyA: "valueA"
        keyB: "valueB"
        keyC: "valueC"
        run: ""
  # continue: false
- name: Rule Test Terminate
  match:
    rules:
      - Test Terminate
  action:
    name: kubernetes:terminate
    parameters:
      # gracePeriodSeconds: 0
- name: Rule Test Exec
  match:
    rules:
      - Test Exec
  action:
    name: kubernetes:exec
    parameters:
      command: "top -n 1"
# - name: Rule Test Script
#   match:
#     rules:
#       - Test Script
#     output_fields:
#       - k8s.pod.name=test
#   action:
#     name: kubernetes:script
#     parameters:
#       shell: "sh"
#       script: |
#         apk add curl
#         curl https://httpbin.org/ip
#         top -n 1 -b
